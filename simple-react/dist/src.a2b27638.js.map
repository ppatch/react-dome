{"version":3,"sources":["src/react-dom/dom.js","src/react-dom/render.js","src/react/component.js","src/react/create-element.js","src/react/index.js","src/react-dom/index.js","src/index.js"],"names":["setAttribute","dom","name","value","test","toLowerCase","style","cssText","removeAttribute","createComponent","component","props","inst","prototype","render","Component","constructor","unmountComponent","componentWillUnmount","removeNode","base","setComponentProps","componentWillMount","componentWillReceiveProps","renderComponent","renderer","componentWillUpdate","_render","componentDidUpdate","componentDidMount","parentNode","replaceChild","aaa","_component","vnode","undefined","String","textNode","document","createTextNode","tag","attrs","createElement","Object","keys","forEach","key","children","child","container","appendChild","isReactComponent","state","stateChange","assign","ReactDOM","Counter","num","setState","onClick","React","handleOnClick","console","log","getElementById"],"mappings":";;AMAA;;AACA;;;ADDA,AHAA,ACCA,ACAA;AHDA;ADAA,AKEA,ADAA,ICAMuD,QAAQ,GAAG;AACfzC,AJFF,EIEEA,MAAM,EAANA,cADe;AAEfU,EAAAA,eAAe,EAAfA;ALDK,AKDU,CAAjB,GLCaxB,YAAY,GAAG,SAAfA,YAAe,CAACC,GAAD,EAAMC,IAAN,EAAYC,KAAZ,EAAsB;AAChD,eKGaoD,ADHA;AJCb,ACFF,AGEIxC,EAAAA,IJAEb,IAAI,CIAG,EAATa,EJAW,WAAb,EAA0Bb,GIDb,CJCiB,GAAG,OAAP,CAFsB,CAIhD;ACHF,AGEIwC,EAAAA,EFJE3B,KDEGN,MGEQ,EAAbiC,OHFJ,CAAyBhC,SAAzB,EAAoCC,KAApC,EAA2C;ADIzC,ACHA,AGDa,MJIT,ACHAC,IAAJ,CADyC,CAEzC,EDEYR,IAAR,CAAaF,IAAb,CAAJ,EAAwB;AACtBA,AGEJ,IHFIA,AGEEwC,IHFE,GAAGxC,IAAI,CAACG,CGEG,GAAG,OHFX,EAAP,AGEEqC,aAAgB,CAACF,GAAD,EAAMC,KAAN,EAA6B;AHD/CxC,ACHF,ACJA,ACQiD,IHD/CA,ECHGS,CDGA,CAACR,IAAD,CAAH,ECHY,CDGAC,ACHCU,KDGI,EEPK,EFOD,ACHlB,EDGH,CAFsB,CAGtB,ACJ0BH,OEIQqC,EFJC,CAAClC,KEIW,IFJrB,CAAoBC,MAAhD,EAAyD;ADKxD,ACJGF,ACLoB,ACQYmC,GHHpC,CCAInC,AEGgCmC,IFH5B,ACLIpC,CFSL,ECJI,CEGsC,CHCtCT,AETa,EDKTQ,EDIA,KAAK,ECJT,CAAeC,IDInB,CCJI,CDIkB,ACJzB,CADqD,CAEzD,mDCNoB,EAAI;AFUtB,ACHD,AECgD,GFJjD,KDMM,CAACR,ACHA,KDGD,IAAU,OAAOA,KAAP,KAAiB,QAA/B,EAAyC;AACvCF,ACHAW,ACRoB,IDQpBA,EDGAX,ECHI,CDGD,CAACK,CCHG,IDGP,ACHWS,CDGDR,OAAV,GAAoBJ,KAAK,ECHlB,CAAeQ,CDGO,EAA7B,ECHO,CAAP;ADID,ACHCC,AEAJ,IFAIA,CDCF,GCDM,CAACI,AEAF,EHGE,IAAIb,KAAK,ACHd,GAAmBO,CDGD,QAAOP,ACHzB,KDGkB,MAAiB,QAA9B,EAAwC;AAC7C,AEZF,ACSAqC,IAAAA,GAAG,EDTEW,ACSLX,EHGM,CGJD,GHIKtC,KAAR,IAAgBC,CEZlB,GAAwB,CFYtB,EAAuB,CEZzB;AFaIF,ACJFW,ACPF,ACQA6B,IFDE7B,AECF6B,IHGIxC,ACJE,CAACa,ACPFsC,ACQA,EHGE,AGHPX,CHGQnC,EEXR,CDOE,CEDG,CHKD,AEXS,CFWCJ,ACJE,CCPhB,IFWI,IAAkB,GCJK,IDIEC,KAAK,CAACD,KAAD,CAAZ,KAAuB,QAAvB,GAAkCC,KAAK,CAACD,KAAD,CAAL,GAAc,IAAhD,GAAuDC,KAAK,CAACD,KAAD,CAA9E;AACD,ACJG,ACPN,ACQA6C,IAAAA,KDRKpC,GCQG,CFDK,CCPb,ACQAoC,GDRapC,CDOKK,ICPlB,ODOa,CAAkBL,KAAlB,CAAP;ADKL,ACJE,ACPJ,ACIM,GAAP,CGTI6C,CLUA;ADOH,ACJA,AECF,CAND,EHCS,MAQA;AACL,QAAItD,IAAI,KAAK,OAAT,IAAoBA,IAAI,IAAID,GAAhC,EAAqC;AACnCA,ACLJ,MDKIA,GAAG,ACLAW,CDKCV,GCLR,CDKO,CAAH,AGJSwC,GHIGvC,KAAK,IAAI,EAArB;AACD,ACLJ,6BCRUkD,aAAa;AINtB,AJOEV,MAAAA,MAAM,CAACW,MIPG3C,AJOV,CAAc,IIPhB,CJOqByC,CIPF,IJOjB,EAA0BC,WAA1B;AIPiB,ANqBjB,ACLJ,ACRI,QFaIlD,CCLCc,IDKL,EAAW,UCLf,CAA2BP,SAA3B,ACRoB,EDQmB,ECRnC;AFcET,ACLF,ACRD,MFaGA,ACLGS,GDKA,CAACV,KCLQ,CAACkB,MDKb,CAAiBhB,IAAjB,EAAuBC,KAAvB,ECLF,EAAsCO,SAAS,CAACQ,oBAAV;AKjBrB,ANuBhB,ACLDC,EAAAA,GDGA,MAEO,CCLG,CAAET,SAAS,CAACU,IAAZ,CAAV;ADMEnB,ACLL,EAED,IDGMA,GAAG,CAACO,eAAJ,CAAoBN,IAApB;AMvBF,ANwBC,iFMxBKS,KAAN;AACA,ANwBD,GA3B+C,CA4BhD,MMzBOyC,KAAL,GAAa;AACXK,ALmBN,MKnBMA,GAAG,ALmBApC,EKnBE,eLmBX,CAA4BX,SAA5B,EAAuCC,KAAvC,EAA+C;AKpB9B,AN0BhB,ACJC,CDzBK,IMGH,CLsBG,CAACD,QCbOK,CDaE,CAACK,IAAhB,EAAuB;AKxBJ,ALyBf,QAAKV,SAAS,CAACY,kBAAf,EAAoCZ,SAAS,CAACY,kBAAV;AKpBvC,ALqBA,GAFD,MAEO,IAAKZ,SAAS,CAACa,yBAAf,EAA2C;AAC9Cb,IAAAA,SAAS,CAACa,yBAAV,CAAqCZ,KAArC;AACH;;AAEDD,EAAAA,SAAS,CAACC,KAAV,GAAkBA,KAAlB,KKvBU;AACR,ALwBFa,EAAAA,SKxBOkC,MLwBQ,CAAEhD,CKxBf,CAAc,OLwBD,CAAf;AKxBkB+C,ALyBnB,EAED,MK3BoBA,GAAG,EAAE,KAAKL,KAAL,CAAWK,GAAX,GAAiB;AAAxB,OAAd;AACD;AL2BI,SAASjC,eAAT,CAA0Bd,SAA1B,EAAsC;AAE3C,MAAIU,IAAJ;AAEA,MAAMK,QAAQ,GAAGf,SAAS,CAACI,EK7BlB,IL6BQ,EAAjB;AK7BS;AL+BT,MAAKJ,SAAS,CAACU,IAAV,IAAkBV,SAAS,CAACgB,mBAAjC,EAAuD;AK9BrD,AL+BEhB,IAAAA,SK9BA,AL8BS,CAACgB,mBAAV;AK9BK,AL+BR,QK/BQ,OAAO,EAAE,KAAKf,KAAL,CAAWgD;AAAzB,oBACU,KAAKhD,KAAL,CAAWT,IADrB,EAEE,oDAAY,KAAKkD,KAAL,CAAWK,GAAvB,CAFF,EAGE;AAAQ,AL8BdrC,EAAAA,IAAI,EK9BU,CL8BPO,MK9Bc,CL8BP,CK9BS,AL8BPF,QAAF,CAAd;AK9BuB,iBAAM,MAAI,CAACkC,OAAL,EAAN;AAAA,ALgCvB,MAAKjD,SAAS,CAACU,IAAf,EAAsB;AKhChB,ALiCF,QAAKV,OKpCL,CADF,CLqCgB,CAACkB,kBAAf,EAAoClB,SAAS,CAACkB,kBAAV;AK9BvC,AL+BA,GAFD,MAEO,IAAKlB,SAAS,CAACmB,iBAAf,EAAmC;AACtCnB,IAAAA,SAAS,CAACmB,iBAAV;AACH;;AAED,EKvDoB+B,ILuDflD,SAAS,CAACU,CKvDWL,GLuDrB,IAAkBL,SAAS,CAACU,IAAV,CAAeU,UAAtC,EAAmD;AAC/CpB,IAAAA,SAAS,CAACU,IAAV,CAAeU,UAAf,CAA0BC,YAA1B,CAAwCX,IAAxC,EAA8CV,SAAS,CAACU,IAAxD;AKjCN,ALkCG,SKlCMyC,aAAT,GAAyB;AAAEC,EAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AAAuB,ALoChDrD,EAAAA,SAAS,CAACU,IAAV,GAAiBA,IAAjB;AACAV,EAAAA,SAAS,CAACsB,GAAV,GAAgB,GAAhB;AKnCFuB,ALoCEnC,EAAAA,IAAI,CAACa,UAAL,CKpCOnB,ELoCWJ,IKpCpB,CACE,ILmCA,yBKnCC,OAAD;AAAS,ALoCV,EKpCU,IAAI,EAAC,KAAd;AAAoB,EAAA,OAAO,EAAEmD;AAA7B,ALsCF,EKvCA,EAEEvB,KLqCOX,GKrCC,CAACqC,GLqCX,CAAmB9B,KAAnB,EAA2B,GKrCzB,CAAwB,MAAxB,CAFF;ALwCE,MAAIA,KAAK,KAAKC,SAAV,IAAuBD,KAAK,KAAK,IAAjC,IAAyC,OAAOA,KAAP,KAAiB,SAA9D,EAAyEA,KAAK,GAAG,EAAR;AAEzE,MAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+BA,KAAK,GAAGE,MAAM,CAACF,KAAD,CAAd;;AAE/B,MAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC7B,QAAMG,QAAQ,GAAGC,QAAQ,CAACC,cAAT,CAAwBL,KAAxB,CAAjB;AACA,WAAOG,QAAP;AACD,GARwB,CAUzB;;;AACA,MAAI,OAAOH,KAAK,CAACM,GAAb,KAAqB,UAAzB,EAAqC;AACnC,QAAM9B,SAAS,GAAGD,eAAe,CAACyB,KAAK,CAACM,GAAP,EAAYN,KAAK,CAACO,KAAlB,CAAjC;AACApB,IAAAA,iBAAiB,CAACX,SAAD,EAAYwB,KAAK,CAACO,KAAlB,CAAjB;AACA,WAAO/B,SAAS,CAACU,IAAjB;AACD;;AAED,MAAMnB,GAAG,GAAGqC,QAAQ,CAACI,aAAT,CAAuBR,KAAK,CAACM,GAA7B,CAAZ;;AAEA,MAAGN,KAAK,CAACO,KAAT,EAAgB;AACdE,IAAAA,MAAM,CAACC,IAAP,CAAYV,KAAK,CAACO,KAAlB,EAAyBI,OAAzB,CAAkC,UAAAC,GAAG,EAAI;AACvC,UAAM3C,KAAK,GAAG+B,KAAK,CAACO,KAAN,CAAYK,GAAZ,CAAd;AACA,6BAAa7C,GAAb,EAAkB6C,GAAlB,EAAuB3C,KAAvB,EAFuC,CAER;AAChC,KAHD;AAID;;AAED+B,EAAAA,KAAK,CAACa,QAAN,IAAkBb,KAAK,CAACa,QAAN,CAAeF,OAAf,CAAuB,UAAAG,KAAK;AAAA,WAAIlC,MAAM,CAACkC,KAAD,EAAQ/C,GAAR,CAAV;AAAA,GAA5B,CAAlB;AAEA,SAAOA,GAAP;AACD;;AAEM,SAASa,MAAT,CAAkBoB,KAAlB,EAAyBe,SAAzB,EAAqC;AAC1C,SAAOA,SAAS,CAACC,WAAV,CAAsBvB,OAAO,CAACO,KAAD,CAA7B,CAAP;AACD","file":"src.a2b27638.js","sourceRoot":"..","sourcesContent":["/**\n设置属性需要考虑一些特殊情况，我们单独将其拿出来作为一个方法setAttribute\n */\nexport const setAttribute = (dom, name, value) => {\n  // 如果属性名是classname,则改回class\n  if (name === 'className') name = 'class';\n\n  // 如果属性名是onXXX,则是一个事件监听方法\n  if (/on\\w+/.test(name)) {\n    name = name.toLowerCase();\n    dom[name] = value || ''\n    // 如果属性名是style,则更新style对象\n  } else if (name === 'style') {\n    if (!value || typeof value === 'string') {\n      dom.style.cssText = value || ''\n    } else if (value && typeof value === 'object') {\n      for(let name in value) {\n        dom.style[name] = typeof value[name] === 'number' ? value[name] + 'px' : value[name];\n      }\n    }\n  } else {\n    if (name !== \"class\" && name in dom) {\n      dom[name] = value || ''\n    }\n\n    if (value) {\n      dom.setAttribute(name, value)\n    } else {\n      dom.removeAttribute(name)\n    }\n  }\n  // 普通属性则直接更新属性\n}","import Component from '../react/component'\nimport { setAttribute } from './dom'\n\n// 创建组件\nfunction createComponent(component, props) {\n  let inst \n  // 如果是类定义组件，则直接返回实例\n  if ( component.prototype && component.prototype.render ) {\n      inst = new component( props );\n  // 如果是函数定义组件，则将其扩展为类定义组件\n  } else {\n      inst = new Component( props );\n      inst.constructor = component;\n      inst.render = function() {\n          return this.constructor( props );\n      }\n  }\n  return inst;\n}\n\nfunction unmountComponent( component ) {\n    if ( component.componentWillUnmount ) component.componentWillUnmount();\n    removeNode( component.base);\n}\n\n// 设置组件props\nfunction setComponentProps( component, props ) {\n\n  if ( !component.base ) {\n      if ( component.componentWillMount ) component.componentWillMount();\n  } else if ( component.componentWillReceiveProps ) {\n      component.componentWillReceiveProps( props );\n  }\n\n  component.props = props;\n\n  renderComponent( component );\n}\n\n// 挂载/更新组件\nexport function renderComponent( component ) {\n\n  let base;\n\n  const renderer = component.render();\n\n  if ( component.base && component.componentWillUpdate ) {\n      component.componentWillUpdate();\n  }\n\n  base = _render( renderer );\n\n  if ( component.base ) {\n      if ( component.componentDidUpdate ) component.componentDidUpdate();\n  } else if ( component.componentDidMount ) {\n      component.componentDidMount();\n  }\n\n  if ( component.base && component.base.parentNode ) {\n      component.base.parentNode.replaceChild( base, component.base );\n  }\n\n  component.base = base;\n  component.aaa = 111\n  base._component = component;\n}\n\nfunction _render ( vnode ) {\n  if (vnode === undefined || vnode === null || typeof vnode === 'boolean') vnode = '';\n\n  if (typeof vnode === 'number') vnode = String(vnode);\n\n  if (typeof vnode === 'string') {\n    const textNode = document.createTextNode(vnode);\n    return textNode\n  }\n\n  // 渲染组件\n  if (typeof vnode.tag === 'function') {\n    const component = createComponent(vnode.tag, vnode.attrs)\n    setComponentProps(component, vnode.attrs)\n    return component.base;\n  }\n\n  const dom = document.createElement(vnode.tag);\n\n  if(vnode.attrs) {\n    Object.keys(vnode.attrs).forEach( key => {\n      const value = vnode.attrs[key]\n      setAttribute(dom, key, value); // 设置属性\n    })\n  }\n\n  vnode.children && vnode.children.forEach(child => render(child, dom))\n\n  return dom\n}\n\nexport function render ( vnode, container ) {\n  return container.appendChild(_render(vnode))\n}\n","import { renderComponent } from '../react-dom/render'\n\nclass Component {\n  constructor(props = {}) {\n    this.isReactComponent = true;\n\n    this.state = {};\n    this.props = props;\n  }\n\n  setState(stateChange) {\n    Object.assign(this.state, stateChange);\n    renderComponent(this);\n  }\n}\nexport default Component;","\n/**\n  从jsx转译结果来看，createElement方法的参数是这样：\n\n  createElement( tag, attrs, child1, child2, child3 );\n  第一个参数是DOM节点的标签名，它的值可能是div，h1，span等等\n  第二个参数是一个对象，里面包含了所有的属性，可能包含了className，id等等\n  从第三个参数开始，就是它的子节点\n\n  我们对createElement的实现非常简单，只需要返回一个对象来保存它的信息就行了。\n */\nconst createElement = (tag, attrs, ...children) => {\n  return {\n    tag,\n    attrs,\n    children\n  }\n}\nexport default createElement;","  \nimport Component from './component.js'\nimport createElement from './create-element.js'\n\nexport default {\n    Component,\n    createElement\n}","import { render, renderComponent } from './render'\n\nconst ReactDOM = {\n  render,\n  renderComponent\n}\n\nexport default ReactDOM;","import React from './react'\nimport ReactDOM from './react-dom'\n\nclass Counter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      num: 1\n    }\n  }\n\n  onClick() {\n    this.setState({ num: this.state.num + 1 });\n  }\n\n  render() {\n    return (\n      <div onClick={this.props.onClick}>\n        hello, {this.props.name}\n        <h1>count: {this.state.num}</h1>\n        <button onClick={() => this.onClick()}>add</button>\n      </div>\n    );\n  }\n}\n\nfunction handleOnClick() { console.log('onClick')}\n\nReactDOM.render(\n  <Counter name='kkk' onClick={handleOnClick}/>,\n  document.getElementById('root')\n);"]}